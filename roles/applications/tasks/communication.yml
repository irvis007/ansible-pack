---
# Install communication tools (no snap!)

# ============================================================================
# Teams for Linux - Unofficial Microsoft Teams client
# Repository: https://github.com/IsmaelMartinez/teams-for-linux
# ============================================================================
- name: "[applications] Ensure /etc/apt/keyrings directory exists"
  become: true
  ansible.builtin.file:
    path: /etc/apt/keyrings
    state: directory
    mode: '0755'
  when: teams_enabled | bool

- name: "[applications] Download Teams for Linux GPG key"
  become: true
  ansible.builtin.get_url:
    url: https://repo.teamsforlinux.de/teams-for-linux.asc
    dest: /etc/apt/keyrings/teams-for-linux.asc
    mode: '0644'
  when: teams_enabled | bool

- name: "[applications] Add Teams for Linux repository"
  become: true
  ansible.builtin.copy:
    dest: /etc/apt/sources.list.d/teams-for-linux-packages.sources
    mode: '0644'
    content: |
      Types: deb
      URIs: https://repo.teamsforlinux.de/debian/
      Suites: stable
      Components: main
      Signed-By: /etc/apt/keyrings/teams-for-linux.asc
      Architectures: amd64
  when: teams_enabled | bool

- name: "[applications] Install Teams for Linux"
  become: true
  ansible.builtin.apt:
    name: teams-for-linux
    state: present
    update_cache: yes
  when: teams_enabled | bool

# ============================================================================
# Slack - Removed (not in use)
# ============================================================================
# To install Slack manually:
# curl -O https://downloads.slack-edge.com/releases/linux/4.40.133/prod/x64/slack-desktop-4.40.133-amd64.deb
# sudo apt install ./slack-desktop-*.deb
