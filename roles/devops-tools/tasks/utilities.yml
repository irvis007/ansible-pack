# install utility tools for Devops role

- name: "[devops-tools] Install Midnight Commander"
  become: true
  ansible.builtin.package:
    name: mc
    state: present
  when: mc_enabled | bool

- name: "[devops-tools] Install 7zip"
  become: true
  ansible.builtin.package:
    name: p7zip-full
    state: present
  when: p7zip_enabled | bool

# yq - yaml processor, like jq
- name: "[devops-tools] Check if yq is installed"
  ansible.builtin.command: yq --version
  register: yq_check
  failed_when: false
  changed_when: false
  when: yq_enabled | bool

- name: "[devops-tools] Download yq binary"
  become: true
  ansible.builtin.get_url:
    url: "https://github.com/mikefarah/yq/releases/latest/download/yq_linux_amd64"
    dest: "/usr/local/bin/yq"
    mode: "0755"
  when:
    - yq_enabled | bool
    - yq_check.rc != 0

# httpie - Modern HTTP client
- name: "[devops-tools] Install HTTPie"
  become: true
  ansible.builtin.apt:
    name: httpie
    state: present
    update_cache: no
  when: httpie_enabled | bool
